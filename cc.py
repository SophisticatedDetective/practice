{"cells":[{"cell_type":"code","source":["2"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">46</span><span class=\"ansired\">]: </span>2\n</div>"]}}],"execution_count":1},{"cell_type":"code","source":["train_rdd=sc.textFile(\"/FileStore/tables/train.csv\")\ntrain_df=spark.read.csv(\"/FileStore/tables/train.csv\")\nprint(train_rdd.take(5),train_df.take(5))"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">[&apos;Date,Open,High,Low,Close,Adj Close,Volume&apos;, &apos;8/22/2006,187.644547,188.404602,186.208893,187.922745,187.922745,8382300&apos;, &apos;8/23/2006,187.599838,187.912811,185.125931,185.508453,185.508453,7331900&apos;, &apos;8/24/2006,186.010178,186.983856,184.927231,185.657471,185.657471,7010200&apos;, &apos;8/25/2006,185.334579,186.447342,185.046448,185.423996,185.423996,4965400&apos;] [Row(_c0=&apos;Date&apos;, _c1=&apos;Open&apos;, _c2=&apos;High&apos;, _c3=&apos;Low&apos;, _c4=&apos;Close&apos;, _c5=&apos;Adj Close&apos;, _c6=&apos;Volume&apos;), Row(_c0=&apos;8/22/2006&apos;, _c1=&apos;187.644547&apos;, _c2=&apos;188.404602&apos;, _c3=&apos;186.208893&apos;, _c4=&apos;187.922745&apos;, _c5=&apos;187.922745&apos;, _c6=&apos;8382300&apos;), Row(_c0=&apos;8/23/2006&apos;, _c1=&apos;187.599838&apos;, _c2=&apos;187.912811&apos;, _c3=&apos;185.125931&apos;, _c4=&apos;185.508453&apos;, _c5=&apos;185.508453&apos;, _c6=&apos;7331900&apos;), Row(_c0=&apos;8/24/2006&apos;, _c1=&apos;186.010178&apos;, _c2=&apos;186.983856&apos;, _c3=&apos;184.927231&apos;, _c4=&apos;185.657471&apos;, _c5=&apos;185.657471&apos;, _c6=&apos;7010200&apos;), Row(_c0=&apos;8/25/2006&apos;, _c1=&apos;185.334579&apos;, _c2=&apos;186.447342&apos;, _c3=&apos;185.046448&apos;, _c4=&apos;185.423996&apos;, _c5=&apos;185.423996&apos;, _c6=&apos;4965400&apos;)]\n</div>"]}}],"execution_count":2},{"cell_type":"code","source":["train_high=train_rdd.map(lambda x:x.split(',')).map(lambda x:x[2])\ntrain_high.take(5)"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">23</span><span class=\"ansired\">]: </span>[&apos;High&apos;, &apos;188.404602&apos;, &apos;187.912811&apos;, &apos;186.983856&apos;, &apos;186.447342&apos;]\n</div>"]}}],"execution_count":3},{"cell_type":"code","source":["train_high_df=train_df.rdd.map(lambda x:x[2])\ntrain_high_df.take(5)"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">10</span><span class=\"ansired\">]: </span>[&apos;High&apos;, &apos;188.404602&apos;, &apos;187.912811&apos;, &apos;186.983856&apos;, &apos;186.447342&apos;]\n</div>"]}}],"execution_count":4},{"cell_type":"code","source":["train_high_df.map(lambda x:x).collect()"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">34</span><span class=\"ansired\">]: </span>\n[&apos;High&apos;,\n &apos;188.404602&apos;,\n &apos;187.912811&apos;,\n &apos;186.983856&apos;,\n &apos;186.447342&apos;,\n &apos;189.244156&apos;,\n &apos;189.924728&apos;,\n &apos;191.082199&apos;,\n &apos;189.840271&apos;,\n &apos;189.408081&apos;,\n &apos;191.454773&apos;,\n &apos;190.356918&apos;,\n &apos;189.641571&apos;,\n &apos;189.164673&apos;,\n &apos;191.102066&apos;,\n &apos;195.096085&apos;,\n &apos;202.06575&apos;,\n &apos;201.827301&apos;,\n &apos;203.700134&apos;,\n &apos;207.992218&apos;,\n &apos;206.402557&apos;,\n &apos;202.378723&apos;,\n &apos;202.905304&apos;,\n &apos;202.408524&apos;,\n &apos;203.402069&apos;,\n &apos;202.522781&apos;,\n &apos;204.281342&apos;,\n &apos;202.175049&apos;,\n &apos;201.499435&apos;,\n &apos;201.688217&apos;,\n &apos;201.916733&apos;,\n &apos;206.541641&apos;,\n &apos;207.768661&apos;,\n &apos;209.591812&apos;,\n &apos;214.579361&apos;,\n &apos;217.5103&apos;,\n &apos;213.565964&apos;,\n &apos;213.451706&apos;,\n &apos;213.362289&apos;,\n &apos;213.213257&apos;,\n &apos;210.505859&apos;,\n &apos;211.002625&apos;,\n &apos;213.362289&apos;,\n &apos;228.563416&apos;,\n &apos;240.75412&apos;,\n &apos;237.386032&apos;,\n &apos;242.671661&apos;,\n &apos;244.390472&apos;,\n &apos;241.052185&apos;,\n &apos;238.677628&apos;,\n &apos;239.522141&apos;,\n &apos;238.016922&apos;,\n &apos;235.334381&apos;,\n &apos;235.344315&apos;,\n &apos;238.280212&apos;,\n &apos;237.96228&apos;,\n &apos;239.313492&apos;,\n &apos;238.19577&apos;,\n &apos;235.826172&apos;,\n &apos;239.030334&apos;,\n &apos;243.391968&apos;,\n &apos;248.309982&apos;,\n &apos;247.231995&apos;,\n &apos;248.215591&apos;,\n &apos;247.589661&apos;,\n &apos;253.352188&apos;,\n &apos;254.842499&apos;,\n &apos;252.11026&apos;,\n &apos;249.268753&apos;,\n &apos;243.34726&apos;,\n &apos;245.7715&apos;,\n &apos;243.615509&apos;,\n &apos;242.617004&apos;,\n &apos;242.140106&apos;,\n &apos;243.138611&apos;,\n &apos;244.609055&apos;,\n &apos;244.310989&apos;,\n &apos;242.721329&apos;,\n &apos;242.870361&apos;,\n &apos;241.608566&apos;,\n &apos;241.181351&apos;,\n &apos;240.311996&apos;,\n &apos;240.490845&apos;,\n &apos;239.810272&apos;,\n &apos;233.138657&apos;,\n &apos;234.226578&apos;,\n &apos;231.12178&apos;,\n &apos;227.838135&apos;,\n &apos;228.250458&apos;,\n &apos;232.527634&apos;,\n &apos;232.776016&apos;,\n &apos;230.734299&apos;,\n &apos;236.789917&apos;,\n &apos;240.411362&apos;,\n &apos;242.174881&apos;,\n &apos;243.352234&apos;,\n &apos;242.54747&apos;,\n &apos;245.180344&apos;,\n &apos;249.253845&apos;,\n &apos;250.868347&apos;,\n &apos;254.842499&apos;,\n &apos;252.2444&apos;,\n &apos;246.635864&apos;,\n &apos;243.794357&apos;,\n &apos;244.733246&apos;,\n &apos;240.808777&apos;,\n &apos;248.155991&apos;,\n &apos;250.619965&apos;,\n &apos;247.341278&apos;,\n &apos;247.763535&apos;,\n &apos;247.390961&apos;,\n &apos;250.868347&apos;,\n &apos;251.370087&apos;,\n &apos;240.932968&apos;,\n &apos;237.455582&apos;,\n &apos;235.120773&apos;,\n &apos;235.64238&apos;,\n &apos;235.344315&apos;,\n &apos;234.812775&apos;,\n &apos;229.701019&apos;,\n &apos;229.89476&apos;,\n &apos;233.04924&apos;,\n &apos;231.558929&apos;,\n &apos;233.555939&apos;,\n &apos;234.847549&apos;,\n &apos;237.793381&apos;,\n &apos;240.55542&apos;,\n &apos;236.933975&apos;,\n &apos;236.089462&apos;,\n &apos;228.414383&apos;,\n &apos;225.369186&apos;,\n &apos;224.74823&apos;,\n &apos;222.900253&apos;,\n &apos;221.310593&apos;,\n &apos;228.016968&apos;,\n &apos;230.073593&apos;,\n &apos;231.245972&apos;,\n &apos;227.718903&apos;,\n &apos;226.154083&apos;,\n &apos;224.504807&apos;,\n &apos;222.880371&apos;,\n &apos;223.456635&apos;,\n &apos;221.906708&apos;,\n &apos;222.800888&apos;,\n &apos;222.353806&apos;,\n &apos;226.809814&apos;,\n &apos;229.591721&apos;,\n &apos;230.197784&apos;,\n &apos;230.997589&apos;,\n &apos;231.111847&apos;,\n &apos;231.216156&apos;,\n &apos;231.494354&apos;,\n &apos;230.202759&apos;,\n &apos;227.783493&apos;,\n &apos;235.592697&apos;,\n &apos;234.971741&apos;,\n &apos;234.519669&apos;,\n &apos;234.971741&apos;,\n &apos;233.873871&apos;,\n &apos;233.183365&apos;,\n &apos;232.487885&apos;,\n &apos;232.870407&apos;,\n &apos;236.953842&apos;,\n &apos;236.655777&apos;,\n &apos;238.399445&apos;,\n &apos;239.417816&apos;,\n &apos;244.658737&apos;,\n &apos;240.932968&apos;,\n &apos;238.439178&apos;,\n &apos;239.129684&apos;,\n &apos;240.659744&apos;,\n &apos;239.641357&apos;,\n &apos;239.119751&apos;,\n &apos;234.87735&apos;,\n &apos;234.017944&apos;,\n &apos;235.503281&apos;,\n &apos;235.885788&apos;,\n &apos;234.882324&apos;,\n &apos;232.572342&apos;,\n &apos;234.340836&apos;,\n &apos;233.228073&apos;,\n &apos;231.991119&apos;,\n &apos;232.244476&apos;,\n &apos;229.775528&apos;,\n &apos;235.04129&apos;,\n &apos;236.07457&apos;,\n &apos;234.822708&apos;,\n &apos;238.051697&apos;,\n &apos;237.957321&apos;,\n &apos;240.143097&apos;,\n &apos;238.051697&apos;,\n &apos;240.908127&apos;,\n &apos;244.310989&apos;,\n &apos;247.808243&apos;,\n &apos;252.746124&apos;,\n &apos;250.878281&apos;,\n &apos;253.605545&apos;,\n &apos;257.82312&apos;,\n &apos;258.707367&apos;,\n &apos;261.548889&apos;,\n &apos;258.141052&apos;,\n &apos;257.450531&apos;,\n &apos;254.181793&apos;,\n &apos;252.626907&apos;,\n &apos;251.305496&apos;,\n &apos;252.855423&apos;,\n &apos;256.332794&apos;,\n &apos;256.953766&apos;,\n &apos;257.698914&apos;,\n &apos;255.980103&apos;,\n &apos;260.798767&apos;,\n &apos;265.766449&apos;,\n &apos;264.877228&apos;,\n &apos;262.289063&apos;,\n &apos;263.039185&apos;,\n &apos;261.995972&apos;,\n &apos;264.206604&apos;,\n &apos;265.473358&apos;,\n &apos;270.44104&apos;,\n &apos;270.177765&apos;,\n &apos;272.597015&apos;,\n &apos;271.732635&apos;,\n &apos;271.484253&apos;,\n &apos;271.891602&apos;,\n &apos;274.549316&apos;,\n &apos;277.485229&apos;,\n &apos;277.062958&apos;,\n &apos;275.458405&apos;,\n &apos;274.971588&apos;,\n &apos;259.899597&apos;,\n &apos;258.319885&apos;,\n &apos;257.669098&apos;,\n &apos;256.839508&apos;,\n &apos;254.638824&apos;,\n &apos;256.640808&apos;,\n &apos;257.992004&apos;,\n &apos;258.538452&apos;,\n &apos;256.586151&apos;,\n &apos;255.83107&apos;,\n &apos;254.941849&apos;,\n &apos;253.426697&apos;,\n &apos;258.260254&apos;,\n &apos;261.191193&apos;,\n &apos;261.707855&apos;,\n &apos;257.684021&apos;,\n &apos;258.195679&apos;,\n &apos;257.02829&apos;,\n &apos;254.191727&apos;,\n &apos;246.611038&apos;,\n &apos;248.881271&apos;,\n &apos;249.656219&apos;,\n &apos;252.438126&apos;,\n &apos;256.457001&apos;,\n &apos;256.397369&apos;,\n &apos;256.109253&apos;,\n &apos;257.053131&apos;,\n &apos;255.826096&apos;,\n &apos;254.991531&apos;,\n &apos;256.034729&apos;,\n &apos;256.581177&apos;,\n &apos;262.294037&apos;,\n &apos;263.029236&apos;,\n &apos;263.203125&apos;,\n &apos;258.935883&apos;,\n &apos;259.348175&apos;,\n &apos;259.139557&apos;,\n &apos;262.284088&apos;,\n &apos;261.901581&apos;,\n &apos;263.421692&apos;,\n &apos;262.929901&apos;,\n &apos;266.88913&apos;,\n &apos;272.949738&apos;,\n &apos;276.600983&apos;,\n &apos;278.583099&apos;,\n &apos;283.883606&apos;,\n &apos;282.939758&apos;,\n &apos;284.047546&apos;,\n &apos;284.022705&apos;,\n &apos;282.934784&apos;,\n &apos;290.286957&apos;,\n &apos;296.476715&apos;,\n &apos;292.59198&apos;,\n &apos;290.654572&apos;,\n &apos;296.07431&apos;,\n &apos;303.158234&apos;,\n &apos;309.874573&apos;,\n &apos;310.81842&apos;,\n &apos;318.632599&apos;,\n &apos;317.137329&apos;,\n &apos;317.86261&apos;,\n &apos;310.937653&apos;,\n &apos;314.951538&apos;,\n &apos;318.612732&apos;,\n &apos;327.117432&apos;,\n &apos;325.383698&apos;,\n &apos;336.610657&apos;,\n &apos;336.546082&apos;,\n &apos;337.29126&apos;,\n &apos;336.084106&apos;,\n &apos;337.802917&apos;,\n &apos;347.693604&apos;,\n &apos;351.215668&apos;,\n &apos;354.553955&apos;,\n &apos;354.484406&apos;,\n &apos;362.755615&apos;,\n &apos;368.49826&apos;,\n &apos;371.205658&apos;,\n &apos;365.070557&apos;,\n &apos;338.736847&apos;,\n &apos;332.800446&apos;,\n &apos;328.324554&apos;,\n &apos;335.5625&apos;,\n &apos;321.657928&apos;,\n &apos;315.691742&apos;,\n &apos;316.327606&apos;,\n &apos;327.420441&apos;,\n &apos;332.820313&apos;,\n &apos;336.948486&apos;,\n &apos;344.459625&apos;,\n &apos;336.029449&apos;,\n &apos;344.906708&apos;,\n &apos;349.124298&apos;,\n &apos;353.232574&apos;,\n &apos;345.254456&apos;,\n &apos;343.76416&apos;,\n &apos;347.206757&apos;,\n &apos;355.964783&apos;,\n &apos;356.680145&apos;,\n &apos;360.058167&apos;,\n &apos;358.165466&apos;,\n &apos;354.85202&apos;,\n &apos;346.556&apos;,\n &apos;347.589264&apos;,\n &apos;345.463104&apos;,\n &apos;336.168549&apos;,\n &apos;337.554535&apos;,\n &apos;343.267365&apos;,\n &apos;347.370697&apos;,\n &apos;348.100952&apos;,\n &apos;354.305573&apos;,\n &apos;355.686615&apos;,\n &apos;351.687622&apos;,\n &apos;348.97525&apos;,\n &apos;346.431793&apos;,\n &apos;341.20578&apos;,\n &apos;338.279816&apos;,\n &apos;329.000183&apos;,\n &apos;327.847656&apos;,\n &apos;324.559052&apos;,\n &apos;326.476593&apos;,\n &apos;322.636566&apos;,\n &apos;326.575928&apos;,\n &apos;322.427917&apos;,\n &apos;317.927185&apos;,\n &apos;310.848236&apos;,\n &apos;303.024109&apos;,\n &apos;296.819489&apos;,\n &apos;282.164795&apos;,\n &apos;287.972015&apos;,\n &apos;295.577545&apos;,\n &apos;284.271088&apos;,\n &apos;278.851349&apos;,\n &apos;278.404236&apos;,\n &apos;284.648621&apos;,\n &apos;266.601013&apos;,\n &apos;254.7332&apos;,\n &apos;252.855423&apos;,\n &apos;253.933411&apos;,\n &apos;255.433655&apos;,\n &apos;257.1922&apos;,\n &apos;260.162903&apos;,\n &apos;263.585632&apos;,\n &apos;265.766449&apos;,\n &apos;268.771912&apos;,\n &apos;264.608978&apos;,\n &apos;265.801208&apos;,\n &apos;253.853928&apos;,\n &apos;254.946823&apos;,\n &apos;252.855423&apos;,\n &apos;251.613495&apos;,\n &apos;231.727829&apos;,\n &apos;236.208694&apos;,\n &apos;237.997055&apos;,\n &apos;238.319962&apos;,\n &apos;234.832642&apos;,\n &apos;225.215195&apos;,\n &apos;225.617569&apos;,\n &apos;225.185379&apos;,\n &apos;218.578354&apos;,\n &apos;214.107437&apos;,\n &apos;218.652878&apos;,\n &apos;222.492905&apos;,\n &apos;222.045807&apos;,\n &apos;223.218185&apos;,\n &apos;215.453674&apos;,\n &apos;218.995651&apos;,\n &apos;222.304123&apos;,\n &apos;216.442245&apos;,\n &apos;231.385056&apos;,\n &apos;227.256912&apos;,\n &apos;229.939468&apos;,\n &apos;222.855545&apos;,\n &apos;225.319519&apos;,\n &apos;219.914673&apos;,\n &apos;231.742737&apos;,\n &apos;236.332886&apos;,\n &apos;230.148102&apos;,\n &apos;237.371124&apos;,\n &apos;241.151535&apos;,\n &apos;235.538055&apos;,\n &apos;234.47496&apos;,\n &apos;235.398956&apos;,\n &apos;232.120285&apos;,\n &apos;227.246979&apos;,\n &apos;228.374649&apos;,\n &apos;227.659302&apos;,\n &apos;228.200775&apos;,\n &apos;272.080383&apos;,\n &apos;269.541901&apos;,\n &apos;278.602966&apos;,\n &apos;277.84787&apos;,\n &apos;275.45343&apos;,\n &apos;274.713257&apos;,\n &apos;276.605957&apos;,\n &apos;279.879639&apos;,\n &apos;290.540314&apos;,\n &apos;295.542786&apos;,\n &apos;299.278473&apos;,\n &apos;297.564636&apos;,\n &apos;294.08725&apos;,\n &apos;297.808044&apos;,\n &apos;292.745972&apos;,\n &apos;290.609863&apos;,\n &apos;291.479218&apos;,\n &apos;292.075317&apos;,\n &apos;293.684875&apos;,\n &apos;289.591492&apos;,\n &apos;290.450897&apos;,\n &apos;292.537323&apos;,\n &apos;289.358002&apos;,\n &apos;288.826477&apos;,\n &apos;275.314331&apos;,\n &apos;274.713257&apos;,\n &apos;279.482239&apos;,\n &apos;283.898499&apos;,\n &apos;291.047028&apos;,\n &apos;293.053955&apos;,\n &apos;290.058441&apos;,\n &apos;288.37439&apos;,\n &apos;287.132477&apos;,\n &apos;292.120026&apos;,\n &apos;288.483704&apos;,\n &apos;283.158325&apos;,\n &apos;277.604462&apos;,\n &apos;276.869232&apos;,\n &apos;277.197113&apos;,\n &apos;285.989899&apos;,\n &apos;287.678925&apos;,\n &apos;287.167267&apos;,\n &apos;282.656586&apos;,\n &apos;280.06842&apos;,\n &apos;276.690399&apos;,\n &apos;274.787781&apos;,\n &apos;273.814117&apos;,\n &apos;277.097748&apos;,\n &apos;270.704315&apos;,\n &apos;263.287567&apos;,\n &apos;267.261719&apos;,\n &apos;266.625854&apos;,\n &apos;268.444031&apos;,\n &apos;267.872742&apos;,\n &apos;272.726166&apos;,\n &apos;275.801178&apos;,\n &apos;276.044586&apos;,\n &apos;272.974548&apos;,\n &apos;268.006866&apos;,\n &apos;268.285065&apos;,\n &apos;262.045654&apos;,\n &apos;266.516571&apos;,\n &apos;266.789795&apos;,\n &apos;247.877792&apos;,\n &apos;240.480896&apos;,\n &apos;238.573303&apos;,\n &apos;247.008453&apos;,\n &apos;246.829605&apos;,\n &apos;244.971695&apos;,\n &apos;244.455063&apos;,\n &apos;242.055664&apos;,\n &apos;241.439667&apos;,\n &apos;238.891235&apos;,\n &apos;235.081024&apos;,\n &apos;234.9767&apos;,\n &apos;238.488861&apos;,\n &apos;243.302551&apos;,\n &apos;240.436188&apos;,\n &apos;246.273224&apos;,\n &apos;252.795807&apos;,\n &apos;251.429688&apos;,\n &apos;250.143066&apos;,\n &apos;252.164917&apos;,\n &apos;253.680054&apos;,\n &apos;253.352188&apos;,\n &apos;247.53006&apos;,\n &apos;246.740189&apos;,\n &apos;243.367126&apos;,\n &apos;245.841034&apos;,\n &apos;246.894196&apos;,\n &apos;240.167938&apos;,\n &apos;235.880829&apos;,\n &apos;236.685593&apos;,\n &apos;233.98317&apos;,\n &apos;239.532074&apos;,\n &apos;235.612564&apos;,\n &apos;230.123276&apos;,\n &apos;224.768097&apos;,\n &apos;225.006546&apos;,\n &apos;214.792984&apos;,\n &apos;210.8685&apos;,\n &apos;216.139221&apos;,\n &apos;219.566925&apos;,\n &apos;219.556992&apos;,\n &apos;223.18837&apos;,\n &apos;218.151138&apos;,\n &apos;218.171005&apos;,\n &apos;229.542053&apos;,\n &apos;225.597702&apos;,\n &apos;218.97081&apos;,\n &apos;221.06221&apos;,\n &apos;223.546051&apos;,\n &apos;217.167542&apos;,\n &apos;210.386642&apos;,\n &apos;211.166565&apos;,\n &apos;207.142731&apos;,\n &apos;203.665359&apos;,\n &apos;204.917206&apos;,\n &apos;186.780182&apos;,\n &apos;186.278442&apos;,\n &apos;178.335098&apos;,\n &apos;173.158768&apos;,\n &apos;169.840347&apos;,\n &apos;189.740921&apos;,\n &apos;195.975372&apos;,\n &apos;178.340073&apos;,\n &apos;177.098145&apos;,\n &apos;191.752838&apos;,\n &apos;189.259048&apos;,\n &apos;190.650009&apos;,\n &apos;183.650528&apos;,\n &apos;177.843307&apos;,\n &apos;174.102631&apos;,\n &apos;170.391769&apos;,\n &apos;183.461761&apos;,\n &apos;184.3013&apos;,\n &apos;184.798065&apos;,\n &apos;184.778198&apos;,\n &apos;180.322174&apos;,\n &apos;184.976898&apos;,\n &apos;183.248154&apos;,\n &apos;171.097183&apos;,\n &apos;169.472748&apos;,\n &apos;163.655579&apos;,\n &apos;157.128036&apos;,\n &apos;155.235336&apos;,\n &apos;155.488693&apos;,\n &apos;161.444962&apos;,\n &apos;154.077866&apos;,\n &apos;150.883652&apos;,\n &apos;149.125092&apos;,\n &apos;140.555817&apos;,\n &apos;133.814667&apos;,\n &apos;134.102783&apos;,\n &apos;142.403793&apos;,\n &apos;146.77536&apos;,\n &apos;147.267166&apos;,\n &apos;142.761475&apos;,\n &apos;137.992493&apos;,\n &apos;139.77092&apos;,\n &apos;140.829041&apos;,\n &apos;141.201614&apos;,\n &apos;153.7202&apos;,\n &apos;157.972534&apos;,\n &apos;156.432556&apos;,\n &apos;155.429077&apos;,\n &apos;157.212479&apos;,\n &apos;158.215958&apos;,\n &apos;163.685379&apos;,\n &apos;160.0242&apos;,\n &apos;159.139954&apos;,\n &apos;157.868225&apos;,\n &apos;153.75&apos;,\n &apos;150.675003&apos;,\n &apos;152.180222&apos;,\n &apos;151.643707&apos;,\n &apos;149.716248&apos;,\n &apos;152.413696&apos;,\n &apos;154.495163&apos;,\n &apos;159.870193&apos;,\n &apos;164.549759&apos;,\n &apos;169.298874&apos;,\n &apos;164.385834&apos;,\n &apos;161.544312&apos;,\n &apos;162.691849&apos;,\n &apos;158.444473&apos;,\n &apos;159.264145&apos;,\n &apos;155.886108&apos;,\n &apos;150.809128&apos;,\n &apos;153.129044&apos;,\n &apos;148.782318&apos;,\n &apos;150.769394&apos;,\n &apos;153.675491&apos;,\n &apos;164.90744&apos;,\n &apos;162.940231&apos;,\n &apos;165.856262&apos;,\n &apos;175.026627&apos;,\n &apos;171.410141&apos;,\n &apos;173.273026&apos;,\n &apos;171.3853&apos;,\n &apos;170.391769&apos;,\n &apos;176.074799&apos;,\n &apos;176.541763&apos;,\n &apos;185.69722&apos;,\n &apos;189.268982&apos;,\n &apos;187.530289&apos;,\n &apos;181.320679&apos;,\n &apos;180.635147&apos;,\n &apos;180.322174&apos;,\n &apos;172.423553&apos;,\n &apos;175.548233&apos;,\n &apos;178.737488&apos;,\n &apos;173.332642&apos;,\n &apos;173.769791&apos;,\n &apos;173.680374&apos;,\n &apos;175.011719&apos;,\n &apos;175.10611&apos;,\n &apos;170.799118&apos;,\n &apos;169.249191&apos;,\n &apos;165.766846&apos;,\n &apos;163.436996&apos;,\n &apos;158.509048&apos;,\n &apos;154.092773&apos;,\n &apos;152.294464&apos;,\n &apos;154.24678&apos;,\n &apos;158.96608&apos;,\n &apos;161.449921&apos;,\n &apos;162.671982&apos;,\n &apos;163.799637&apos;,\n &apos;166.586517&apos;,\n &apos;168.901459&apos;,\n &apos;166.914383&apos;,\n &apos;165.419113&apos;,\n &apos;173.595932&apos;,\n &apos;175.776749&apos;,\n &apos;174.534821&apos;,\n &apos;178.419556&apos;,\n &apos;174.862686&apos;,\n &apos;170.794144&apos;,\n &apos;175.612808&apos;,\n &apos;176.472214&apos;,\n &apos;183.685303&apos;,\n &apos;184.658966&apos;,\n &apos;183.715103&apos;,\n &apos;180.699722&apos;,\n &apos;181.320679&apos;,\n &apos;185.965469&apos;,\n &apos;188.325119&apos;,\n &apos;187.276947&apos;,\n &apos;189.298798&apos;,\n &apos;195.180542&apos;,\n &apos;198.618179&apos;,\n &apos;194.062805&apos;,\n &apos;190.908325&apos;,\n &apos;193.739914&apos;,\n &apos;193.615723&apos;,\n &apos;195.319641&apos;,\n &apos;193.486557&apos;,\n &apos;193.267975&apos;,\n &apos;196.208847&apos;,\n &apos;200.57048&apos;,\n &apos;197.510391&apos;,\n &apos;199.899841&apos;,\n &apos;201.191437&apos;,\n &apos;202.820847&apos;,\n &apos;201.186478&apos;,\n &apos;203.739868&apos;,\n &apos;204.668823&apos;,\n &apos;204.167084&apos;,\n &apos;196.914261&apos;,\n &apos;194.837769&apos;,\n &apos;195.781631&apos;,\n &apos;197.371292&apos;,\n &apos;199.522293&apos;,\n &apos;201.524277&apos;,\n &apos;200.118423&apos;,\n &apos;198.036957&apos;,\n &apos;201.191437&apos;,\n &apos;204.599274&apos;,\n &apos;204.480057&apos;,\n &apos;207.266922&apos;,\n &apos;213.411957&apos;,\n &apos;213.590805&apos;,\n &apos;214.832718&apos;,\n &apos;219.194351&apos;,\n &apos;222.22464&apos;,\n &apos;219.035385&apos;,\n &apos;218.826736&apos;,\n &apos;217.530182&apos;,\n &apos;215.463623&apos;,\n &apos;212.468094&apos;,\n &apos;209.388138&apos;,\n &apos;209.184464&apos;,\n &apos;208.503876&apos;,\n &apos;207.992218&apos;,\n &apos;208.87149&apos;,\n &apos;207.396088&apos;,\n &apos;203.173553&apos;,\n &apos;204.783081&apos;,\n &apos;206.606232&apos;,\n &apos;212.731384&apos;,\n &apos;212.517776&apos;,\n &apos;212.224686&apos;,\n &apos;211.822296&apos;,\n &apos;206.362808&apos;,\n &apos;203.993225&apos;,\n &apos;203.272903&apos;,\n &apos;201.688217&apos;,\n &apos;205.88591&apos;,\n &apos;207.336472&apos;,\n &apos;210.888382&apos;,\n &apos;211.986237&apos;,\n &apos;217.922623&apos;,\n &apos;221.434784&apos;,\n &apos;216.332962&apos;,\n &apos;215.026459&apos;,\n &apos;214.554535&apos;,\n &apos;213.710022&apos;,\n &apos;219.179443&apos;,\n &apos;223.789459&apos;,\n &apos;221.931549&apos;,\n &apos;219.974274&apos;,\n &apos;217.485474&apos;,\n &apos;224.276306&apos;,\n &apos;224.887329&apos;,\n &apos;225.483444&apos;,\n &apos;225.533127&apos;,\n &apos;226.978729&apos;,\n &apos;225.970276&apos;,\n &apos;228.225616&apos;,\n &apos;227.723877&apos;,\n &apos;227.137695&apos;,\n &apos;229.383087&apos;,\n &apos;230.85849&apos;,\n &apos;230.09346&apos;,\n &apos;224.534622&apos;,\n &apos;222.403473&apos;,\n &apos;221.06221&apos;,\n &apos;229.596695&apos;,\n &apos;231.539063&apos;,\n &apos;233.526138&apos;,\n &apos;235.64238&apos;,\n &apos;234.971741&apos;,\n &apos;232.776016&apos;,\n &apos;234.658768&apos;,\n &apos;229.437729&apos;,\n &apos;231.901703&apos;,\n &apos;227.684128&apos;,\n &apos;227.644394&apos;,\n &apos;229.805344&apos;,\n &apos;231.98616&apos;,\n &apos;231.628479&apos;,\n &apos;233.948395&apos;,\n &apos;235.120773&apos;,\n &apos;236.859451&apos;,\n &apos;237.907639&apos;,\n &apos;243.103851&apos;,\n &apos;247.078003&apos;,\n &apos;246.884262&apos;,\n &apos;247.838058&apos;,\n &apos;249.373062&apos;,\n &apos;251.861877&apos;,\n &apos;249.084946&apos;,\n &apos;248.349731&apos;,\n &apos;249.129654&apos;,\n &apos;248.2603&apos;,\n &apos;248.454041&apos;,\n &apos;246.630905&apos;,\n &apos;244.281189&apos;,\n &apos;244.623962&apos;,\n &apos;248.071533&apos;,\n &apos;257.818146&apos;,\n &apos;259.934387&apos;,\n &apos;259.070007&apos;,\n &apos;261.181274&apos;,\n &apos;262.025787&apos;,\n &apos;266.05954&apos;,\n &apos;266.715271&apos;,\n &apos;275.582611&apos;,\n &apos;275.011322&apos;,\n &apos;274.688416&apos;,\n &apos;277.867737&apos;,\n &apos;275.706787&apos;,\n &apos;277.142456&apos;,\n &apos;279.005341&apos;,\n &apos;275.48822&apos;,\n &apos;273.222961&apos;,\n &apos;274.13205&apos;,\n &apos;273.307404&apos;,\n &apos;267.987&apos;,\n &apos;267.013336&apos;,\n &apos;270.987488&apos;,\n &apos;273.108704&apos;,\n &apos;274.107208&apos;,\n &apos;279.47229&apos;,\n &apos;282.552277&apos;,\n &apos;284.897034&apos;,\n &apos;284.598969&apos;,\n &apos;284.405212&apos;,\n &apos;286.630737&apos;,\n &apos;286.884094&apos;,\n &apos;287.519958&apos;,\n &apos;285.145416&apos;,\n &apos;283.953156&apos;,\n &apos;291.404694&apos;,\n &apos;290.257172&apos;,\n &apos;291.633209&apos;,\n &apos;289.348083&apos;,\n &apos;289.949158&apos;,\n &apos;293.699768&apos;,\n &apos;294.588989&apos;,\n &apos;293.814026&apos;,\n &apos;295.493103&apos;,\n &apos;292.442932&apos;,\n &apos;293.42157&apos;,\n &apos;292.760864&apos;,\n &apos;295.433502&apos;,\n &apos;295.453369&apos;,\n &apos;296.725098&apos;,\n &apos;296.263092&apos;,\n &apos;298.245209&apos;,\n &apos;296.889038&apos;,\n &apos;297.529846&apos;,\n &apos;297.981903&apos;,\n &apos;298.806549&apos;,\n &apos;304.454803&apos;,\n &apos;307.758331&apos;,\n &apos;310.972412&apos;,\n &apos;310.401154&apos;,\n &apos;309.352966&apos;,\n &apos;310.679321&apos;,\n &apos;312.721039&apos;,\n &apos;311.891449&apos;,\n &apos;310.907837&apos;,\n &apos;303.029083&apos;,\n &apos;299.675903&apos;,\n &apos;300.276978&apos;,\n &apos;297.147339&apos;,\n &apos;292.28894&apos;,\n &apos;295.180145&apos;,\n &apos;294.862213&apos;,\n &apos;293.302338&apos;,\n &apos;291.09671&apos;,\n &apos;291.513977&apos;,\n &apos;283.45639&apos;,\n &apos;273.16333&apos;,\n &apos;273.024231&apos;,\n &apos;272.055542&apos;,\n &apos;271.732635&apos;,\n &apos;268.74707&apos;,\n &apos;266.173798&apos;,\n &apos;265.751556&apos;,\n &apos;269.298462&apos;,\n &apos;267.261719&apos;,\n &apos;265.026245&apos;,\n &apos;269.24881&apos;,\n &apos;269.01532&apos;,\n &apos;267.15741&apos;,\n &apos;268.498688&apos;,\n &apos;266.839478&apos;,\n &apos;270.306915&apos;,\n &apos;269.944275&apos;,\n &apos;270.74408&apos;,\n &apos;270.257233&apos;,\n &apos;271.981018&apos;,\n &apos;270.058533&apos;,\n &apos;267.480286&apos;,\n &apos;262.537445&apos;,\n &apos;264.156921&apos;,\n &apos;264.921936&apos;,\n &apos;271.066956&apos;,\n &apos;272.289032&apos;,\n &apos;276.268127&apos;,\n &apos;282.000854&apos;,\n &apos;280.763916&apos;,\n &apos;280.505585&apos;,\n &apos;287.380859&apos;,\n &apos;291.210968&apos;,\n &apos;292.239258&apos;,\n &apos;282.885101&apos;,\n &apos;282.373444&apos;,\n &apos;283.878632&apos;,\n &apos;282.383362&apos;,\n &apos;282.164795&apos;,\n &apos;281.593506&apos;,\n &apos;277.351105&apos;,\n &apos;278.116119&apos;,\n &apos;284.151855&apos;,\n &apos;281.861755&apos;,\n &apos;280.5354&apos;,\n &apos;281.980988&apos;,\n &apos;283.029175&apos;,\n &apos;284.872192&apos;,\n &apos;285.58255&apos;,\n &apos;283.600464&apos;,\n &apos;282.537354&apos;,\n &apos;283.083801&apos;,\n &apos;282.547302&apos;,\n &apos;285.145416&apos;,\n &apos;292.537323&apos;,\n &apos;294.256134&apos;,\n &apos;296.988373&apos;,\n &apos;282.567169&apos;,\n &apos;275.205048&apos;,\n &apos;278.021729&apos;,\n &apos;278.314819&apos;,\n &apos;274.464874&apos;,\n &apos;272.885132&apos;,\n &apos;270.734131&apos;,\n &apos;267.425659&apos;,\n &apos;265.686951&apos;,\n &apos;266.516571&apos;,\n &apos;267.102753&apos;,\n &apos;264.738129&apos;,\n &apos;261.668091&apos;,\n &apos;256.193695&apos;,\n &apos;257.087891&apos;,\n &apos;251.027313&apos;,\n &apos;259.720764&apos;,\n &apos;258.260254&apos;,\n &apos;254.365601&apos;,\n &apos;259.313416&apos;,\n &apos;253.843994&apos;,\n &apos;252.537491&apos;,\n &apos;253.834061&apos;,\n &apos;248.106308&apos;,\n &apos;241.221085&apos;,\n &apos;240.932968&apos;,\n &apos;243.312485&apos;,\n &apos;237.182358&apos;,\n &apos;243.297577&apos;,\n &apos;244.564346&apos;,\n &apos;245.130661&apos;,\n &apos;243.94339&apos;,\n &apos;245.33931&apos;,\n &apos;252.358643&apos;,\n &apos;252.979614&apos;,\n &apos;248.836563&apos;,\n &apos;242.840561&apos;,\n &apos;242.860428&apos;,\n &apos;242.671661&apos;,\n &apos;242.77597&apos;,\n &apos;245.652267&apos;,\n &apos;248.583206&apos;,\n &apos;250.371567&apos;,\n &apos;251.300537&apos;,\n &apos;250.108292&apos;,\n &apos;248.866364&apos;,\n &apos;246.69548&apos;,\n &apos;241.871857&apos;,\n &apos;239.815231&apos;,\n &apos;237.281708&apos;,\n &apos;237.23204&apos;,\n &apos;230.774033&apos;,\n &apos;227.435745&apos;,\n &apos;222.751221&apos;,\n &apos;219.710999&apos;,\n &apos;222.38858&apos;,\n &apos;224.186874&apos;,\n &apos;227.187363&apos;,\n &apos;235.100891&apos;,\n &apos;238.170929&apos;,\n &apos;244.902145&apos;,\n &apos;245.319427&apos;,\n &apos;245.751617&apos;,\n &apos;233.759613&apos;,\n &apos;233.307556&apos;,\n &apos;239.934464&apos;,\n &apos;241.280701&apos;,\n &apos;242.91011&apos;,\n &apos;243.7099&apos;,\n &apos;243.789383&apos;,\n &apos;247.142578&apos;,\n &apos;246.024841&apos;,\n &apos;242.860428&apos;,\n &apos;242.105331&apos;,\n &apos;245.046204&apos;,\n &apos;244.638855&apos;,\n &apos;251.861877&apos;,\n &apos;252.656708&apos;,\n &apos;251.235947&apos;,\n &apos;251.11673&apos;,\n &apos;251.365112&apos;,\n ...]\n</div>"]}}],"execution_count":5},{"cell_type":"code","source":["train_df.createOrReplaceTempView('train_df')\nspark.sql('''\nselect *  from train_df\nwhere \"High\"=\"188.404602\"\n''').show()"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">+---+---+---+---+---+---+---+\n_c0|_c1|_c2|_c3|_c4|_c5|_c6|\n+---+---+---+---+---+---+---+\n+---+---+---+---+---+---+---+\n\n</div>"]}}],"execution_count":6},{"cell_type":"code","source":["ss=sc.parallelize(['ss','cc'])"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":7},{"cell_type":"code","source":["ss.collect()"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">28</span><span class=\"ansired\">]: </span>[&apos;ss&apos;, &apos;cc&apos;]\n</div>"]}}],"execution_count":8},{"cell_type":"code","source":["ss.filter(lambda x:x.startswith('c')).collect()"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">29</span><span class=\"ansired\">]: </span>[&apos;cc&apos;]\n</div>"]}}],"execution_count":9},{"cell_type":"code","source":["aa=sc.parallelize([('aa',12),('dd',33),('ii',77)])\naa.filter(lambda x:x[1]==12).collect()"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">31</span><span class=\"ansired\">]: </span>[(&apos;aa&apos;, 12)]\n</div>"]}}],"execution_count":10},{"cell_type":"code","source":["aa.toDF().toPandas().iloc[0]"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">38</span><span class=\"ansired\">]: </span>\n_1    aa\n_2    12\nName: 0, dtype: object\n</div>"]}}],"execution_count":11},{"cell_type":"code","source":["aa.filter(lambda x:x[0].startswith('i') and x[1]==77).collect()"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">44</span><span class=\"ansired\">]: </span>[(&apos;ii&apos;, 77)]\n</div>"]}}],"execution_count":12},{"cell_type":"code","source":["aa.collect()"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">43</span><span class=\"ansired\">]: </span>[(&apos;aa&apos;, 12), (&apos;dd&apos;, 33), (&apos;ii&apos;, 77)]\n</div>"]}}],"execution_count":13},{"cell_type":"code","source":["aa.sample(False,0.3,0).collect()"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">45</span><span class=\"ansired\">]: </span>[(&apos;ii&apos;, 77)]\n</div>"]}}],"execution_count":14},{"cell_type":"code","source":["rdd1=sc.parallelize([('a',11),('c',22),('d',22)])\nrdd2=sc.parallelize([('a',44),('c',22),('v',99)])\nrdd3=rdd1.leftOuterJoin(rdd2)"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":15},{"cell_type":"code","source":["rdd3.collect()"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">49</span><span class=\"ansired\">]: </span>[(&apos;c&apos;, (22, 22)), (&apos;a&apos;, (11, 44)), (&apos;d&apos;, (22, None))]\n</div>"]}}],"execution_count":16},{"cell_type":"code","source":["rdd3.map(lambda x:(x[0],x[1][0])).collect()"],"metadata":{},"outputs":[{"metadata":{},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">51</span><span class=\"ansired\">]: </span>[(&apos;c&apos;, 22), (&apos;a&apos;, 11), (&apos;d&apos;, 22)]\n</div>"]}}],"execution_count":17},{"cell_type":"code","source":[""],"metadata":{},"outputs":[],"execution_count":18}],"metadata":{"name":"xx","notebookId":4119822246208826},"nbformat":4,"nbformat_minor":0}
